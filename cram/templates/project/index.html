{% load static %}
<!DOCTYPE html>
<html>
  <head>
    <meta charset="UTF-8">

    <link href="{% static 'cram/css/default.css' %}" rel="stylesheet">
    <script type="text/javascript" src="{% static 'cram/js/index.js' %}"></script>

  </head>
  <body>
  <div style="text-align: center;">
    <h1>å¡¾è¬›å¸«æŒ‡å°å ±å‘Šæ›¸</h1>
    <h3>æ‚ªç”¨å³ç¦</h3>
    <p>
      <a href="{% url 'speech_view' %}">
        <img src="{% static 'cram/img/skyhigh.png' %}" width="240" height="180" alt="ã‚¹ãƒ”ãƒ¼ãƒã¡ã‚ƒã‚“ã¸">
      </a>
    </p>
    <p>ğŸ‘†ã‚¹ãƒ”ãƒ¼ãƒã¡ã‚ƒã‚“ã¸GO!!</p>
    <button id="start-btn">æ–‡å­—èµ·ã“ã—ã—ã¦ã­</button>
    <button id="stop-btn">æ­¢ã‚ã¾ã—ã‚‡ã†</button>
    <div id="result-div"></div>

    <form action="{% url 'index' %}" method="post">
      {% csrf_token %}
      <div>
        <label for="titleInput">ç”Ÿå¾’æ°å</label><br>
        <input id="titleInput" name="title" type="text" row="1" placeholder="å ±å‘Šã®ã‚¿ã‚¤ãƒˆãƒ«ã‚’å…¥åŠ›ã—ã¦ã­â™¡">
      </div>
      <div>
        <label for="textInput">è©³ç´°</label><br>
        <!--<textarea id="textInput" name="text" rows="3" placeholder="ä½•ã‹å…¥åŠ›ã—ã¦ã­â™¡"></textarea>-->
        <textarea id="textInput" name="text" rows="3" placeholder="ç‚¹æ•°ãªã©å…¥åŠ›ã—ã¦ã­â™¡"></textarea>
      </div>
      <div>
        <button class="report-button" type="submit">å ±å‘Š</button>
      </div>
      <style>
        /* Add this CSS code within the <head> tag or in an external CSS file */
        .report-button {
          background-color: #4CAF50; /* Set the background color */
          color: white; /* Set the text color */
          padding: 10px 20px; /* Adjust the padding */
          font-size: 16px; /* Adjust the font size */
          border: none; /* Remove the border */
          cursor: pointer; /* Add a cursor pointer */
          border-radius: 5px; /* Add rounded corners */
        }
      
        /* Optional: Add hover effect */
        .report-button:hover {
          background-color: #45a049;
        }
      </style>
      
      
    </form>
    <p>â€»ä¿è­·è€…æ§˜ãŒä¸å¿«ã«æ€ã†ã“ã¨ã‚’æŠ•ç¨¿ã™ã‚‹ãªã€‚</p>
    <p>â€»æ‚ªç”¨ã—ãŸå ´åˆã€æ³•çš„æªç½®ã‚’å–ã‚‰ã›ã¦ã„ãŸã ãã¾ã™ã€‚</p>
    <br>
    <br>
    <div>
      <a href="{% url 'index' %}?sort=Date" id="sort_new">æ–°ç€é †</a>
      {% comment %} <a href="{% url 'index' %}?sort=like" id="sort_like">â™¡é †</a> {% endcomment %}
      <input type="button" class="report-button" value="å°åˆ·" onclick="window.print();" />
    </div>
    <br>
    <br>
    {% if articles %}
    {% for article in articles %}
    <div class="text">
    <small>[{{ article.posted_at }}]</small>
    <h2><a href="{% url 'detail' article.id %}">{{ article.title }}</a></h2>
    </div>
    <div>
      <a href=""onclick="like({{article.id}});">
        â™¡:<span id="like{{article.id}}">{{ article.like }}</span>
      </a>
      <form action="{% url 'delete' article.id %}" method="POST">
        {% csrf_token %}
        <input type="submit" class="report-button" value="å‰Šé™¤">
    </form>
    </div>
    {% endfor %}
    {% else %}
    <p>No article.</p>
    {% endif %}

    <form action="{% url 'index' %}" method="post">
      {% csrf_token %}
      <label for="searchInput">YouTubeå‹•ç”»ã‚’æ¤œç´¢:</label><br>
      <input id="searchInput" name="keyword" type="text" placeholder="ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰ã‚’å…¥åŠ›">
      <button type="submit">æ¤œç´¢</button>
  </form>
  
    {% if videos %}
    <h2>YouTube å‹•ç”»</h2>
    {% for video in videos %}
        <div class="video">
            <h3><a href="{{ video.url }}">{{ video.title }}</a></h3>
            <img src="{{ video.thumbnail }}" alt="{{ video.title }}" />
            <p>{{ video.description }}</p>
        </div>
    {% endfor %}
    {% endif %}

    {% comment %} <form method="post" enctype="multipart/form-data">
      {% csrf_token %}
      <label for="fileInput">ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰ã™ã‚‹:</label><br>
      <input id="fileInput" type="file" name="file">
      <button type="submit">ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰</button>
    </form>

    {% if image_url %}
      <img src="{{ image_url }}" alt="ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰ã•ã‚ŒãŸç”»åƒ">
    {% endif %} {% endcomment %}
    
    <p>ã“ã®ä»˜è¿‘ã§ã™ã€‚</p>
    <iframe src="https://www.google.com/maps/embed?pb=!1m18!1m12!1m3!1d3235.677907582629!2d139.84263751436646!3d35.8078398306271!2m3!1f0!2f0!3f0!3m2!1i1024!2i768!4f13.1!3m3!1m2!1s0x6018900d65a25555%3A0x46f85833948553da!2z5YWr5r2u6aeF!5e0!3m2!1sja!2sjp!4v1680854922254!5m2!1sja!2sjp" width="600" height="450" style="border:0;" allowfullscreen="" loading="lazy" referrerpolicy="no-referrer-when-downgrade"></iframe>

  </div>
  <script>
    const startButton = document.getElementById('start-btn');
    const stopButton = document.getElementById('stop-btn');
    const resultDiv = document.getElementById('result-div');
    const textInput = document.getElementById('textInput');
    
    let recognition;
    
    if ('webkitSpeechRecognition' in window) {
      recognition = new webkitSpeechRecognition();
      recognition.continuous = true;
      recognition.interimResults = true;
      recognition.lang = 'ja-JP';
  
      recognition.onstart = function() {
        resultDiv.innerHTML = 'éŸ³å£°èªè­˜ã‚’é–‹å§‹ã—ã¾ã—ãŸ';
      };
  
      recognition.onerror = function(event) {
        if (event.error === 'no-speech') {
          resultDiv.innerHTML = 'éŸ³å£°ã‚’æ¤œå‡ºã§ãã¾ã›ã‚“ã§ã—ãŸã€‚ã‚‚ã†ä¸€åº¦è©¦ã—ã¦ãã ã•ã„ã€‚';
        }
      };
  
      recognition.onend = function() {
        recognition.stop();
        startButton.disabled = false;
        stopButton.disabled = true;
      };
  
      recognition.onresult = function(event) {
        let final_transcript = '';
        let interim_transcript = '';
        for (let i = event.resultIndex; i < event.results.length; ++i) {
          if (event.results[i].isFinal) {
            final_transcript += event.results[i][0].transcript;
          } else {
            interim_transcript += event.results[i][0].transcript;
          }
        }
        textInput.value = final_transcript;
        resultDiv.innerHTML = interim_transcript; // ä¸­é–“çµæœã‚’è¡¨ç¤ºã—ã¾ã™ã€‚æœ€çµ‚çµæœãŒå¾—ã‚‰ã‚Œã‚‹ã¾ã§
      };
  
    } else {
      resultDiv.innerHTML = 'ã“ã®ãƒ–ãƒ©ã‚¦ã‚¶ã¯Web Speech APIã‚’ã‚µãƒãƒ¼ãƒˆã—ã¦ã„ã¾ã›ã‚“ã€‚';
    }
  
    startButton.addEventListener('click', function() {
      recognition.start();
      startButton.disabled = true;
      stopButton.disabled = false;
    });
  
    stopButton.addEventListener('click', function() {
      recognition.stop();
      startButton.disabled = false;
      stopButton.disabled = true;
    });
  </script>
  </body>
</html>